<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://wixtoolset.org/schemas/v4/wxs">

  <Package
      Name="AccountingHub"
      Version="1.0.0"
      Manufacturer="JJ Software"
      UpgradeCode="C7B0E03C-3E15-4E8A-9A77-8EAB2C6B7031"
      InstallerVersion="500"
      Scope="perMachine">

    <MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />

    <Feature Id="MainFeature" Title="AccountingHub" Level="1">
      <ComponentGroupRef Id="ProductComponents" />
      <ComponentRef Id="StartMenuShortcut" />
    </Feature>
  </Package>

  <!-- ================== Directories ================== -->
  <Fragment>
    <StandardDirectory Id="ProgramFilesFolder">
      <Directory Id="INSTALLFOLDER" Name="AccountingHub" />
    </StandardDirectory>

    <StandardDirectory Id="ProgramMenuFolder">
      <Directory Id="ApplicationProgramsFolder" Name="AccountingHub" />
    </StandardDirectory>
  </Fragment>

  <!-- ================== Components ================== -->
  <Fragment>
    <ComponentGroup Id="ProductComponents" Directory="INSTALLFOLDER">

      <Component Id="ExeFile" Guid="C1111111-1111-1111-1111-111111111111">
        <File Source="publish\AccountingHub.Desktop.exe" KeyPath="yes" />
      </Component>

      <Component Id="DllDesktop" Guid="C2222222-2222-2222-2222-222222222222">
        <File Source="publish\AccountingHub.Desktop.dll" />
      </Component>

      <Component Id="DllDomain" Guid="C3333333-3333-3333-3333-333333333333">
        <File Source="publish\AccountingHub.Domain.dll" />
      </Component>

      <Component Id="DllInfrastructure" Guid="C4444444-4444-4444-4444-444444444444">
        <File Source="publish\AccountingHub.Infrastructure.dll" />
      </Component>

      <Component Id="DllPayroll" Guid="C5555555-5555-5555-5555-555555555555">
        <File Source="publish\AccountingHub.Payroll.dll" />
      </Component>

      <Component Id="DepsJson" Guid="C6666666-6666-6666-6666-666666666666">
        <File Source="publish\AccountingHub.Desktop.deps.json" />
      </Component>

      <Component Id="RuntimeConfig" Guid="C7777777-7777-7777-7777-777777777777">
        <File Source="publish\AccountingHub.Desktop.runtimeconfig.json" />
      </Component>

    </ComponentGroup>

    <Component Id="StartMenuShortcut" Directory="ApplicationProgramsFolder" Guid="C8888888-8888-8888-8888-888888888888">
      <Shortcut
        Id="AppShortcut"
        Name="AccountingHub"
        Target="[INSTALLFOLDER]AccountingHub.Desktop.exe"
        Description="AccountingHub Desktop Application"
        WorkingDirectory="INSTALLFOLDER" />
      <RemoveFolder Id="RemoveShortcutFolder" On="uninstall" />
      <RegistryValue
        Root="HKCU"
        Key="Software\JJSoftware\AccountingHub"
        Name="installed"
        Type="integer"
        Value="1"
        KeyPath="yes" />
    </Component>

  </Fragment>

</Wix>
